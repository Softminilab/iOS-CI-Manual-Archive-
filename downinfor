#!/bin/sh
isReplaceImgSource="1"
if [[ $isReplaceImgSource = "1" ]]; then
	curl -o icon.png https://www.shapegoapp.com/images/shapego-icon-1024.png
	# # $? æ˜¾ç¤ºå‘½ä»¤æœ€åçš„é€€å‡ºçŠ¶æ€ï¼Œ0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯
	if [[ "$?" -eq 0 ]]; then
		echo "succeful"
	else
		exit 0;
	fi

	iconPackageName="AppIcon.appiconset"
	cp icon.png icon1.png
	sh ~/Documents/GitLab/Shell/createicon icon.png
	rm -rf icon1.png

	if [[ "$?" -eq 0 ]]; then
		echo "succeful"
	else
		exit 0;
	fi
fi

# # # åœä¸€ä¼šä¼š ä¸ç„¶å¤ªå¿«äº† ğŸ˜†
# sleep 2

echo "å¼€å§‹é…ç½®app"
# appæ˜¾ç¤ºçš„åç§°
lineAppName="Styleç‰ˆæœ¬"
lineAppPackName="H5DEFAULT002"

# appGitåœ°å€çš„å¯¹åº”çš„åç§°
style="H5STYLE"
default="H5DEFAULT"
King="H5KING"

case $lineAppPackName in
	*$style*) 
		appPackName=`echo ${lineAppPackName//${style}/"Style"}`
		finaPackageName=$appPackName
		 ;;
	*$default*) 
		appPackName=`echo ${lineAppPackName//${default}/"Default"}` 
		finaPackageName=Default003
		;;
	*$King*) 
		appPackName=`echo ${lineAppPackName//${King}/"King"}` 
		finaPackageName="BorchyKing"
		;;
esac

echo "appPackName---> $appPackName"
echo "finaPackageName---> $finaPackageName"


echo "æ‰€å±Gitï¼šiOS group"
gitUrl="http://xxx/ios/${appPackName}.git"
echo "git url: $gitUrl"
if [ -e $appPackName ]; then
	echo "$appPackName é¡¹ç›®å·²å­˜åœ¨"
else 
	git clone $gitUrl
	if [[ "$?" -eq 0 ]]; then
		echo "æ‹‰å–ä»£ç åˆ°æœ¬åœ°æˆåŠŸ"
	else
		echo "æ‹‰å–ä»£ç é”™è¯¯"
		exit 0;
	fi
fi

if [[ $isReplaceImgSource = "1" ]]; then
	echo "å›¾ç‰‡æ›¿æ¢"
	# æ›¿æ¢App icon
	originIconDir=`find ./${appPackName} -name "Assets.xcassets"`
	cp -r $iconPackageName $originIconDir
	if [[ "$?" -eq 0 ]]; then
		echo "å›¾ç‰‡æ›¿æ¢æˆåŠŸ"
	else
		echo "å›¾ç‰‡æ›¿æ¢å¤±è´¥"
		exit 0;
	fi
fi


# æ›¿æ¢Lunch img
# Todo

projectDir=`find ./${appPackName} -name "${finaPackageName}.xcworkspace"`
echo $projectDir

cd $projectDir
echo $projectDir

echo "ç›®å½•æ˜¯ï¼š$projectDir"

echo "å¼€å§‹æ‰§è¡Œ Update pod"
pod repo update && pod update
if [[ "$?" -eq 0 ]]; then
	echo "pod æˆåŠŸ"
else 
	echo "pod å¤±è´¥äº†"
	exit 0;
fi

echo "æ‰“åŒ…äº†"
cd ..
# pwd
sh ~$HOME/Documents/GitLab/Shell/createpack $lineAppName

